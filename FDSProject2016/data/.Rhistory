v = c(1,4,4,3,2,2,3)
v[v<3]
v
v<3
[v<3]
v[v<3]
??run
floor(a)
ceiling(a)
a = runif(3, min=0, max=100)
floor(a)
ceiling(a)
round(a,4)
a = runif(3, min=0, max=100)
floor(a)
a = runif(3, min=0, max=100)
floor(a)
ceiling(a)
round(a,4)
data1=read.csv(file="~/Dropbox/Data_Science/RSlides/test.csv")
data3=read.csv("http://www.macalester.edu/~kaplan/ISM/datasets/swim100m.csv")
set.seed(123)
x=rnorm(100,mean=100,sd=10)
set.seed(234)
y=rnorm(100,mean=100,sd=10)
hist(x,breaks=20)
plot(x)
qqline(x)
qqnorm(x)
plot(x)
par(mfrow=c(2,2)) #setup layout
plot(rnorm(50),pch=17)
plot(rnorm(20),type="l",lty=5)
plot(rnorm(100),cex=0.5)
plot(rnorm(200),lwd=2)
plot(x)
par(mfrow=c(1,1)) #setup layout
plot(x)
x = matrix(1:20, nrow=5, ncol=4, byrow=TRUE)
y = matrix(1:20, nrow=5, ncol=4, byrow=FALSE)
y
x
x[1,4]
x[2,c(2,4)]
x[2,c(2,3,4)]
x[3:5, 2]
x[2,c(2:4)]
rnames=c("apple","banana","orange","melon","corn")
cnames=c("cat","dog","bird","pig")
rownames(x)=rnames
colnames(x)=cnames
x
diabetes = c("Type1", "Type2", "Type1", "Type1")
status = c("Poor", "Improved", "Excellent", "Poor")
patientdata = data.frame(patientID, age, diabetes, status)
patientdata
patientID = c(1, 2, 3, 4)
age = c(25, 34, 28, 52)
diabetes = c("Type1", "Type2", "Type1", "Type1")
status = c("Poor", "Improved", "Excellent", "Poor")
patientdata = data.frame(patientID, age, diabetes, status)
patientdata
patientdata[1:2,] #first two row
patientdata[1:2]  #first two column
View(patientdata)
View(x)
View(data3)
mylist = list(patientdata, swim, x)
mylist
mylist = list(patientdata, swim, x)
swim = read.csv("http://www.macalester.edu/~kaplan/ISM/datasets/swim100m.csv")
mylist = list(patientdata, swim, x)
mylist
swim
patiendata
x
mylist
mylist
mylist = list(patientdata, swim, x)
mylist
mylist[[3]][1:2,]
dat = data.frame(patientdata, swim) #won't work
attach(mtcars)
mtcars
attach(mtcars)
mtcars
attach(x)
for(i in 1:10){
print(i)
}
i = 1
while(i <= 10){
print(i)
i=i+1
}
while(i <= 10){
print(i)
i=i+2
}
print(i)
i = 1
while(i <= 10){
print(i)
i=i+2
}
feelings = c("sad", "afraid")
for (i in feelings){
print(
switch(i,
happy  = "I am glad you are happy",
afraid = "There is nothing to fear",
sad    = "Cheer up",
angry  = "Calm down now"
)
)
}
myfunction = function(x,a,b,c){
curve(myfunction(x,20,3,4),xlim=c(1,20))
myfeeling = function(x){
for (i in x){
print(
switch(i,
happy  = "I am glad you are happy",
afraid = "There is nothing to fear",
sad    = "Cheer up",
angry  = "Calm down now"
)
)
}
}
myfeeling = function(x){
for (i in x){
print(
switch(i,
happy  = "I am glad you are happy",
afraid = "There is nothing to fear",
sad    = "Cheer up",
angry  = "Calm down now"
)
)
}
}
myfeeling = function(x){
for (i in x){
print(
switch(i,
happy  = "I am glad you are happy",
afraid = "There is nothing to fear",
sad    = "Cheer up",
angry  = "Calm down now"
)
)
}
}
myfeeling = function(x){
for (i in x){
print(
switch(i,
happy  = "I am glad you are happy",
afraid = "There is nothing to fear",
sad    = "Cheer up",
angry  = "Calm down now"
)
)
}
}
head(mtcars)
summary(mtcars)
summary(mtcars)
mtcars
clear
exit
attach(mtcars)
table(cyl)
summary(mpg)
table(cut(mpg,seq(10,34,by=2)))
#Correlations
states = state.x77[,1:6]
cov(states)
var(states)
cor(states)
states
states = state.x77[,1:6]
states = state.x77[,1:6]
View(swim)
View(swim)
View(patientdata)
View(patientdata)
View(patientdata)
View(data3)
x = rnorm(100, mean = 10, sd = 1)
y = rnorm(100, mean = 30, sd = 10)
View(data3)
x = rnorm(100, mean = 10, sd = 1)
y = rnorm(100, mean = 30, sd = 10)
t.test(x, y, alt = "two.sided",paired=TRUE)
states = state.x77[,1:6]
cov(states)
par(mfrow=c(2,1))
boxplot(data[2:4],horizontal=TRUE)
boxplot(difference,horizontal=TRUE)
par(mfrow=c(1,1))
qqnorm(difference)
set.seed(123)
A = matrix(sample(100,15), nrow=5, ncol=3)
set.seed(234)
B = matrix(sample(100,15), nrow=5, ncol=3)
set.seed(321)
X = matrix(sample(100,25), nrow=5, ncol=5)
set.seed(213)
b = matrix(sample(100,5),nrow=5, ncol=1)
A
A + 2
t(A)
t(A)
B
t(A) %*% B
colMeans(A)
colSums(A)
rowMeans(A)
rowSums(A)
A
crossprod(A)
A %*% A
A * A
crossprod(A)
diag(A)
diag(X)
eigen(X)
?max
install.packages("twitteR")
install.packages("twitteR")
# importing the library
library(twitteR)
#setup the credentials
consumerKey <-	'hX7ACg00LwB0J00lcgDIUKgTK'
consumerSecret <- '	OnVothZz0nTdqi1hYK06WltcC1WX8WbQdGSJiTGlp7MappyCTx'
accessToken <- '465606029-Im9hqIUOOjfdT7nTUT25nDdsNi2EL4hfHCs3iT0h'
accessSecret <- 'hBn5Mov0bkQjXXwjzp08PLpJU9UbN1GeJNxdErK6PB2Ot'
# seting up the authentication
setup_twitter_oauth(consumerKey, consumerSecret, accessToken, accessSecret)
setup_twitter_oauth(consumerKey, consumerSecret, accessToken, accessSecret)
#getting data from the twitter api
tw <- searchTwitter("brooklyn nets", n = 100, lang = "en", resultType = "recent")
tw
consumerKey <-	'hX7ACg00LwB0J00lcgDIUKgTK'
consumerSecret <- '	OnVothZz0nTdqi1hYK06WltcC1WX8WbQdGSJiTGlp7MappyCTx'
accessToken <- '465606029-Im9hqIUOOjfdT7nTUT25nDdsNi2EL4hfHCs3iT0h'
accessSecret <- 'hBn5Mov0bkQjXXwjzp08PLpJU9UbN1GeJNxdErK6PB2Ot'
# seting up the authentication
setup_twitter_oauth(consumerKey, consumerSecret, accessToken, accessSecret)
consumerKey <-	'hX7ACg00LwB0J00lcgDIUKgTK'
consumerSecret <- 'OnVothZz0nTdqi1hYK06WltcC1WX8WbQdGSJiTGlp7MappyCTx'
accessToken <- '465606029-Im9hqIUOOjfdT7nTUT25nDdsNi2EL4hfHCs3iT0h'
accessSecret <- 'hBn5Mov0bkQjXXwjzp08PLpJU9UbN1GeJNxdErK6PB2Ot'
# seting up the authentication
setup_twitter_oauth(consumerKey, consumerSecret, accessToken, accessSecret)
#getting data from the twitter api
tw <- searchTwitter("brooklyn nets", n = 100, lang = "en", resultType = "recent")
tw
#data cleaning, we will use a new package called tm, choose 'no' while installing
install.packages("tm")
txV = sapply(tw, function(x)  x$getText())
txV
documents <- Corpus(VectorSource(twV))
documents <- Corpus(VectorSource(twV))
install.packages("tm")
library(tm)
# convert list to vector
txV = sapply(tw, function(x)  x$getText())
txV
# create a document collection (corpus) from the vector
documents <- Corpus(VectorSource(twV))
documents <- Corpus(VectorSource(txV))
#clean up the text
#defining a new function
#to remove the url links
removeURL <- function(x) gsub('http.*\\s*','',x)
documentsClean <- tm_map(documents, content_transformer(removeURL))
documentsClean <- tm_map(documentsClean, removePunctuation)
documentsClean <- tm_map(documentsClean, content_transformer(tolower))
documentsClean <- tm_map(documentsClean, content_transformer(toupper))
documentsClean <- tm_map(documentsClean, content_transformer(tolower))
documentsClean <- tm_map(documentsClean, removeWords, stopwords("english"))
documentsClean <- tm_map(documentsClean, removeNumbers)
documentsClean <- tm_map(documentsClean, stripWhitespace)
documentsClean <- tm_map(documentsClean, removeWords, c ("brooklyn", "nets", "brooklynnets"))
documentsClean <- tm_map(documentsClean, removeWords, c ("brooklyn", "nets", "brooklynnets", "nba"))
install.packages("wordcloud")
wordcloud(documentsClean)
wordcloud(documentsClean)
install.packages("wordcloud")
library(wordcloud)
wordcloud(documentsClean)
wordcloud(documentsClean, scale= c(1, 0.2))
wordcloud(documentsClean, scale= c(10, 0.5))
wordcloud(documentsClean, random.order = F, scale= c(10, 0.5))
wordcloud(documentsClean, random.order = F, scale= c(10, 0.5), col = rainbow())
wordcloud(documentsClean, random.order = F, scale= c(10, 0.5), col = rainbow(7))
# setting up the libraries
# require(caTools)
# install.packages('randomForest')
library(gdata)
library(car)
library(caret)
library(caTools)
library(ggbiplot,vqv)
library(randomForest)
# setting the working directory
# /Users/kkiran/Desktop/fall_2016/fds/project/MovieScorePredictor/data
setwd('/Users/kkiran/Desktop/fall_2016/fds/project/MovieScorePredictor/data/')
movieData = read.xls("movie_data.xls")
# head(movieData)
# identifying top 10 genres out of all the 26 genres to make the work more focussed
# gernes present in the data:
# 'Sci-Fi', 'Crime', Romance', Animation', Music', Comedy', War', genres', Horror', Film-Noir', Adventure', News', Reality-TV', Thriller', Western', Mystery', Short', Drama', Action', Documentary', Musical', History', Family', Fantasy', Game-Show', Sport', Biography'
movieCount <- c()
for(i in 38:64)
{
movieCount[i - 37] = sum(movieData[,i]);
}
movieCount
genreNames <- as.vector(colnames(movieData)[38:64])
genreNames
genreNames <- as.vector(genreNames)
genreMovieCount <- data.frame(genreNames, movieCount)
plot(genreMovieCount$genreNames, genreMovieCount$movieCount, main="Genre Distribution",	xlab="Genre ", ylab=" Movies Made")
View(genreMovieCount)
genreMovieCountSorted <- genreMovieCount[order(-movieCount),]
genreMovieCountSorted <- genreMovieCountSorted[c(1:10),]
plot(genreMovieCountSorted$genreNames, genreMovieCountSorted$movieCount, main="Filtered Genre Distribution",	xlab="Genre ", ylab=" Movies Made")
View(genreMovieCountSorted)
movieData <- movieData[,-65]
columnNames <- colnames(movieData)
columnNames <- columnNames[1:37]
selectedNames <- genreMovieCountSorted$genreNames
columnNames <- as.vector(columnNames)
selectedNames <- as.vector(selectedNames)
names <- c(columnNames, selectedNames)
names
movieData1 <- subset(movieData, select = names)
# for(i in 38:47)
# {
#   print(c(colnames(movieData1[i]), sum(movieData1[,i])));
# }
View(movieData1)
mean(is.na(movieData))
print(c("only", mean(is.na(movieData)), " amount of data is null, so we can safely remove NAs"))
print(c("only", mean(is.na(movieData)), " amount of data is null, so we can safely remove NAs"))
paste("only", mean(is.na(movieData)), " amount of data is null, so we can safely remove NAs")
row.has.na <- apply(movieData1, 1, function(x){any(is.na(x))})
numberOfNAs <- sum(row.has.na)
print (c("can remove ", numberOfNAs , "from the table"))
print (c("can remove ", numberOfNAs , "null rows from the table"))
movieData1 <- na.omit(movieData1)
NAcounter <- 0
indicesToRemove <- c()
index <- 1
# this is the working version
for (i in 1 : nrow(movieData1)) {
if (any(movieData1[i,] == "N/A")) {
print (c(i, "yes" , movieData1[i,]))
indicesToRemove[index] = i;
index <- index + 1
NAcounter <- NAcounter + 1
} else
print ("no")
}
print(length(indicesToRemove))
print(indicesToRemove)
print(c("total number of nulls", NAcounter))
movieData2 <- movieData1[-indicesToRemove,]
movieData2[movieData2==""] <- NA
row.has.na <- apply(movieData2, 1, function(x){any(is.na(x))})
numberOfNAs <- sum(row.has.na)
print(c("There are ",numberOfNAs, " rows with empty cells, so we are removing them"))
paste("There are ",numberOfNAs, " rows with empty cells, so we are removing them")
movieData2$profits <- movieData2$gross - movieData2$budget
movieData3 <- movieData2[,c(c(1:13),48, c(14:47))]
str(movieData3)
nearZeroVar(movieData3, saveMetrics = T)
stat <- nearZeroVar(movieData3, saveMetrics = T)
stat$zeroVar
str(stat$zeroVar)
class(stat$zeroVar)
varDF <- as.data.frame(c(colnames(movieData3),stat$zeroVar))
View(varDF)
varDF <- cbind.data.frame(c(colnames(movieData3),stat$zeroVar))
View(varDF)
varDF <- cbind.data.frame(colnames(movieData3),stat$zeroVar)
View(varDF)
cols <- sapply(varDF, is.logical)
varDF[,cols] <- lapply(varDF[,cols], as.numeric)
for ( i in 1: count(varDF) )
print(i)
for ( i in 1:nrows(varDF) )
print(i)
for ( i in 1:rows(varDF) )
print(i)
for ( i in 1:length(varDF) )
print(i)
for ( i in 1:nrow(varDF) )
print(i)
for ( i in 1:nrow(varDF)) {
print(varDF[i,1])
}
for ( i in 1:nrow(varDF)) {
print(varDF[i,0])
}
for ( i in 1:nrow(varDF)) {
print(varDF[i,])
}
for ( i in 1:nrow(varDF)) {
print(varDF[i,1])
}
for ( i in 1:nrow(varDF)) {
print(varDF[i,2])
}
View(varDF)
varDF <- cbind.data.frame(colnames(movieData3),stat$zeroVar)
View(varDF)
cols <- sapply(varDF, is.logical)
varDF[,cols] <- lapply(varDF[,cols], as.numeric)
head(varDF)
View(varDF)
plot(varDF$`colnames(movieData3)`, varDF$`stat$zeroVar`)
plot(varDF$`colnames(movieData3)`, varDF$`stat$zeroVar`, xlab = "predictors", ylab = "Zero - variance")
plot(varDF$`colnames(movieData3)`, varDF$`stat$zeroVar`, xlab = "predictors", ylab = "Zero - variance", main = "xyz")
plot(varDF$`colnames(movieData3)`, varDF$`stat$zeroVar`, xlab = "predictors", ylab = "Zero - variance", main = "zero variance scores of different possible predictors")
paste("we can see that all the columns have a zero score for the zero-variance score showing that all the columns can participate as a predictor in the prediction model")
#coverting factor to int array
movieData3$tomatoUserRating <- as.numeric(as.character(movieData3$tomatoUserRating))
movieData3$tomatoRating <- as.numeric(as.character(movieData3$tomatoRating))
movieData3$tomatoReviews <- as.numeric(as.character(movieData3$tomatoReviews))
movieData3$tomatoFresh <- as.numeric(as.character(movieData3$tomatoFresh))
movieData3$tomatoRotten <- as.numeric(as.character(movieData3$tomatoRotten))
movieData3$tomatoUserMeter <- as.numeric(as.character(movieData3$tomatoUserMeter))
movieData3$tomatoUserReviews <- as.numeric(as.character(movieData3$tomatoUserReviews))
movieData3$imdbVotes <- as.numeric(as.character(movieData3$imdbVotes))
movieData3$Metascore <- as.numeric(as.character(movieData3$Metascore))
cor(movieData3$imdb_score, movieData3[,c(7,12:26,38)], use = "pairwise.complete.obs")
colnames(movieData3)[c(7,12:26,38)]
View(movieData3)
cor(movieData3$imdb_score, movieData3[,c(7,12:26,38 ,-15)], use = "pairwise.complete.obs")
colnames(movieData3)[c(7,12:26,38,-15)]
colnames(movieData3)[c(7,12:14,16:26,38)]
cor(movieData3$imdb_score, movieData3[,c(7,12:14,16:26,38)], use = "pairwise.complete.obs")
colnames(movieData3)[c(7,12:14,16:26,38)]
cNames <- paste("movieData3$",colnames(movieData3)[c(7,12:14,16:26,38)], sep = "")
cNames
formula <- as.formula(paste("y ~ ", paste(cNames, collapse= "+")))
formula
lmfit1.movieData <- lm(movieData3$imdb_score ~ movieData3$cast_total_facebook_likes + movieData3$gross + movieData3$budget + movieData3$num_critic_for_reviews +movieData3$num_user_for_reviews + movieData3$tomatoUserRating + + movieData3$tomatoRating + movieData3$tomatoReviews + movieData3$tomatoFresh + movieData3$tomatoUserMeter + movieData3$tomatoUserReviews + movieData3$num_voted_users +  movieData3$imdbVotes + movieData3$duration ,data = movieData3)
summary(lmfit1.movieData)
vif(lmfit1.movieData)
summary(lmfit1.movieData)$coefficients
lmfit2.movieData <- lm(movieData3$imdb_score ~ movieData3$cast_total_facebook_likes + movieData3$gross + movieData3$budget + movieData3$num_critic_for_reviews +movieData3$num_user_for_reviews + movieData3$tomatoUserRating + + movieData3$tomatoRating + movieData3$tomatoReviews + movieData3$tomatoFresh + movieData3$tomatoUserMeter + movieData3$tomatoUserReviews + movieData3$duration ,data = movieData3)
summary(lmfit2.movieData)
predictedScore <- predict(lmfit2.movieData)
predictedScore
RSFE_v <- movieData3$imdb_score - predictedScore
RSFE_v
RSFE <- sum(RSFE_v)
RSFE
absRSFE <- abs(RSFE)
absRSFE
length(RSFE_v)
MSFE <- absRSFE / length(RSFE_v)
MSFE
mean(lmfit2.movieData$residuals^2)
trans = preProcess(movieData3[,c(7,12:26,38)], method=c("BoxCox", "center", "scale", "pca"))
trans
trans$pcaComp
pca.movieData <- prcomp(movieData3[,c(7,12:26,38)], center = TRUE, scale. = TRUE)
print(pca.movieData)
mean(lmfit2.movieData$residuals^2)
trans = preProcess(movieData3[,c(7,12:26,38)], method=c("BoxCox", "center", "scale", "pca"))
trans
trans$pcaComp
pca.movieData <- prcomp(movieData3[,c(7,12:26,38)], center = TRUE, scale. = TRUE)
trans = preProcess(movieData3[,c(7,12:14,16:26,38)], method=c("BoxCox", "center", "scale", "pca"))
trans
trans$pcaComp
pca.movieData <- prcomp(movieData3[,c(7,12:14,16:26,38)], center = TRUE, scale. = TRUE)
trans = preProcess(movieData3[,c(7,12:14,16:26,38)], method=c("BoxCox", "center", "scale", "pca"))
trans
trans$pcaComp
trans$pcaComp
trans
pca.movieData <- prcomp(movieData3[,c(7,12:14,16:26,38)], center = TRUE, scale. = TRUE)
pca.movieData <- prcomp(x = movieData3[,c(7,12:14,16:26,38)], center = TRUE, scale. = TRUE)
View(movieData3)
# setting the working directory
# /Users/kkiran/Desktop/fall_2016/fds/project/MovieScorePredictor/data
setwd('/Users/kkiran/Desktop/fall_2016/fds/project/MovieScorePredictor/data/')
movieData = read.xls("movie_data.xls")
# head(movieData)
